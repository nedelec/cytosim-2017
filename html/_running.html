<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cytosim: Running simulations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cytosim
   &#160;<span id="projectnumber">PI</span>
   </div>
   <div id="projectbrief">Cytoskeleton Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_running.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Running simulations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This describes some simple ways to run one or many simulations on a computer. You must have access to the unix-style command line:</p><ul>
<li>on Mac OS X, open Applications/Utilities/Terminal</li>
<li>go to the directory where the executable and parameter file are located.</li>
</ul>
<p>If the directory is named <code>cytosim/run</code>: </p><div class="fragment"><div class="line">cd cytosim/run</div></div><!-- fragment --><p>You can verify the content of the directory: </p><div class="fragment"><div class="line">ls</div></div><!-- fragment --><p>If you are unfamiliar with the <code>Command Line <a class="el" href="class_interface.html" title="Cytosim Application Programming Interface. ">Interface</a></code>, you may want to follow one of the many good tutorials available online.</p>
<h2>Live Run </h2>
<p>To run a program, you need to specify the full path of the corresponding executable. If cytosim's executable <code>play</code> is present in the current directory, you can type:</p>
<div class="fragment"><div class="line">./play live</div></div><!-- fragment --><p>this should open a graphical window and start a live simulation using <code>config.cym</code>. You can specify another configuration file:</p>
<div class="fragment"><div class="line">./play live spindle.cym</div></div><!-- fragment --><p>By configuring your <a href="http://en.wikipedia.org/wiki/PATH_(variable)">PATH</a> to include the directory where the executable is located, you may be able to just type:</p>
<div class="fragment"><div class="line">play live</div></div><!-- fragment --><p>In the following, only the executable name will be specified. If you get the error <code>command not found</code>, you need either to specify the full path of the executable, or to configure your search path (<code>$PATH</code>).</p>
<h2>Normal Run </h2>
<p>The canonical way to use cytosim is to call <code>sim</code> to calculate a simulation, and then <code>play</code> to display the results once <code>sim</code> has finished:</p>
<div class="fragment"><div class="line">sim</div><div class="line">play</div></div><!-- fragment --><p>This will use the configuration <code>config.cym</code> in the current directory.</p>
<p>If you do not want to wait until <code>sim</code> finishes, you may run <code>sim</code> in the background:</p>
<div class="fragment"><div class="line">sim&amp;</div></div><!-- fragment --><p>You can then use <code>play</code> to display the results at any time, even if the simulation is not completed.</p>
<h2>Overnight Run </h2>
<p>You should not run two simulations in the same directory, because the output files are always named in the same way, and the results will be losts. The good practice is to run every simulation in a separate directory.</p>
<p>In addition, if the calculation requires an hour to complete or more, you should probably use <a href="http://en.wikipedia.org/wiki/Nohup">nohup</a> to prevent the simulation from being automatically terminated when you log out:</p>
<p>Here is an example: </p><div class="fragment"><div class="line">mkdir run0</div><div class="line">cp config.cym run0</div><div class="line">cd run0</div><div class="line">nohup ../sim&amp;</div></div><!-- fragment --><p>To automate this, you can use the script <code>/python/run/start.py</code>: it will automatically create the new directory, and start the simulation: </p><div class="fragment"><div class="line">start.py sim config.cym</div></div><!-- fragment --><p>You can call <code>start.py</code> many times, and the new directories will be named <code>run0000</code>, <code>run0001</code>, etc.</p>
<h2>Visual Inspection </h2>
<p>You should now have many completed simulations, each in a different directory. You can look at them, using a few python scripts located in /python/look:</p>
<table class="doxtable">
<tr>
<th>Script </th><th>Typical usage  </th></tr>
<tr>
<td><code>make_image.py</code> </td><td>create one image in each directory </td></tr>
<tr>
<td><code>make_movie.py</code> </td><td>create a movie in each directory </td></tr>
<tr>
<td><code>make_page.py</code> </td><td>create a HTML page to easily view all the images </td></tr>
<tr>
<td><code>scan.py</code> </td><td>run a command in multiple directories </td></tr>
</table>
<p>For example:</p>
<p>Create HTML directory with a single image </p><div class="fragment"><div class="line">make_image.py <span class="stringliteral">&#39;play window_size=1024,128 frame=100&#39;</span> run*</div><div class="line">make_page.py run*</div></div><!-- fragment --><p>Create HTML directory with images every 100 frame: </p><div class="fragment"><div class="line">scan.py <span class="stringliteral">&#39;../play movie period=100 size=256 label={}&#39;</span> run*</div><div class="line">make_page.py run*</div></div><!-- fragment --><p>Open <code>page.html</code> in a browser to view the results.</p>
<h2>Analysis </h2>
<p>You can also analyse the runs in a non-visual way:</p>
<table class="doxtable">
<tr>
<th>Program </th><th>Typical usage  </th></tr>
<tr>
<td><code>report</code> </td><td>extract data from trajectory files </td></tr>
<tr>
<td><code>get_data.py</code> </td><td>collect data from the directories into one master file </td></tr>
<tr>
<td><code>make_plots.py</code> </td><td>make a plot </td></tr>
</table>
<p>Cytosim's tool <code>report</code> will generate some output from the trajectory file of a completed simulation. You may use <code>scan.py</code> to analyse a set of directories. It is however generally better to include some reporting directly into the config file, with the <a class="el" href="_sim_commands.html">command</a> <code>write</code>.</p>
<hr/>
<p>The tools and python scripts should be able provide up-to-date help, for example: </p><div class="fragment"><div class="line">make_page.py help</div><div class="line">make_image.py help</div></div><!-- fragment --><h3>Restarting a Simulation </h3>
<p>One can start a simulation from a frame stored in a trajectory file. Follow these steps:</p><ol type="1">
<li>build the accessory program <code>frametool</code> if needed.</li>
<li>using <code>frametool</code>, extract the desired frame.</li>
<li>adjust the <code>config.cym</code> to import this frame.</li>
</ol>
<p>For 1, you may use <code>make</code>: </p><div class="fragment"><div class="line">make frametool</div></div><!-- fragment --><p>For 2, you need to provide a trajectory file, and the index of the frame to extract:  frametool objects.cmo 30 &gt; objects.cmi  This will create the file ‘objects.cmi’ containing frame 30, where the frame index start at 0. You need to replace <code>30</code> with the appropriate index. Note that ‘frametool objects.cmo’ will tell you how many frames are contained in the file.</p>
<p>For 3, use the ‘import’ command within a config file to read the frame:</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> objects objects.cmi</div><div class="line"></div><div class="line">run 1000000 <a class="code" href="namespace_player.html#a463e08d31ad9a7921e595e35a74538cd">simul</a> *</div><div class="line">{</div><div class="line">nb_frames = 100</div><div class="line">}</div></div><!-- fragment --><p>The ‘import’ command replaces all the objects of the simulation, without changing the Properties. The config file should thus define all the Properties with ’set’ as usual, but skip all the ’new’ instructions. From an existing configuration, one simply adds the 'import' and deletes all the 'new'.</p>
<p>However, any ’new’ after ‘import’ will add objects as usual. The simulation should be started in a fresh directory, as ’sim’ will erase the ‘object.cmo’ file.</p>
<p>One can merge two trajectory files later with 'cat' if necessary: </p><div class="fragment"><div class="line">cat objects1.cmo objects2.cmo &gt; objects.cmo</div></div><!-- fragment --><h3>Conversion </h3>
<p>With <code>sim</code>, it is possible to extract a frame from a binary trajectory file, and export it in the text-based format. The text-based format is a plain ascii file containing all the simulation state variables.</p>
<p>Simply execute a following config file: </p><div class="fragment"><div class="line">include properties.cmo</div><div class="line"><span class="keyword">import</span> objects.cmo { frame = 10 }</div><div class="line">export objects objects.txt { binary=0 }</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">index</a></li>
    <li class="footer">Generated on Thu Jan 25 2018 10:37:05 for Cytosim by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
